import{h as D,w as E,au as I,r as z,q as d,X as p,o as i,O as u,P as n,_ as v,k as g,V as c,U as V,z as e,m as y,l as q,p as s,$ as N,a8 as R,W as f,Z as $}from"./vue-9888607f.js";import{t as B}from"./index-d68ba36c.js";import{F as o}from"./index-d87f9e8e.js";import{b as m}from"./validate-905cfe5c.js";const T={class:"title"},h=D({__name:"popupForm",setup(W){const b=E(),a=I("baTable"),{t:l}=B(),k=z({name:[m({name:"required",title:l("sms.variable.name")}),m({name:"varName"})],value_source:[m({name:"required",title:l("sms.variable.value_source")})],value:[m({name:"required",title:l("sms.variable.value")})],sql:[m({name:"required",title:l("sms.variable.sql")})],namespace:[m({name:"required",title:l("sms.variable.namespace")})],class:[m({name:"required",title:l("sms.variable.class")})],func:[m({name:"required",title:l("sms.variable.func")})],param:[m({name:"required",title:l("sms.variable.param")})]});return(H,t)=>{const P=d("el-form"),C=d("el-scrollbar"),_=d("el-button"),U=d("el-dialog"),F=p("drag"),S=p("zoom"),w=p("loading"),x=p("blur");return i(),u(U,{class:"ba-operate-dialog","close-on-click-modal":!1,"model-value":!!e(a).form.operate,onClose:e(a).toggleForm},{header:n(()=>[v((i(),g("div",T,[c(V(e(a).form.operate?e(l)(e(a).form.operate):""),1)])),[[F,[".ba-operate-dialog",".el-dialog__header"]],[S,".ba-operate-dialog"]])]),footer:n(()=>[y("div",{style:q("width: calc(100% - "+e(a).form.labelWidth/1.8+"px)")},[s(_,{onClick:t[11]||(t[11]=r=>e(a).toggleForm(""))},{default:n(()=>[c(V(e(l)("Cancel")),1)]),_:1}),v((i(),u(_,{loading:e(a).form.submitLoading,onClick:t[12]||(t[12]=r=>e(a).onSubmit(b.value)),type:"primary"},{default:n(()=>[c(V(e(a).form.operateIds&&e(a).form.operateIds.length>1?e(l)("Save and edit next item"):e(l)("Save")),1)]),_:1},8,["loading"])),[[x]])],4)]),default:n(()=>[v((i(),u(C,{class:"ba-table-form-scrollbar"},{default:n(()=>[y("div",{class:N(["ba-operate-form","ba-"+e(a).form.operate+"-form"]),style:q("width: calc(100% - "+e(a).form.labelWidth/2+"px)")},[e(a).form.loading?f("",!0):(i(),u(P,{key:0,ref_key:"formRef",ref:b,onKeyup:t[10]||(t[10]=R(r=>e(a).onSubmit(b.value),["enter"])),model:e(a).form.items,"label-position":"right","label-width":e(a).form.labelWidth+"px",rules:k},{default:n(()=>[s(o,{label:e(l)("sms.variable.title"),type:"string",modelValue:e(a).form.items.title,"onUpdate:modelValue":t[0]||(t[0]=r=>e(a).form.items.title=r),prop:"title","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.title")})}},null,8,["label","modelValue","input-attr"]),s(o,{label:e(l)("sms.variable.name"),type:"string",modelValue:e(a).form.items.name,"onUpdate:modelValue":t[1]||(t[1]=r=>e(a).form.items.name=r),prop:"name",attr:{blockHelp:"可在短信模板中使用变量，发送短信时自动计算变量值：${"+(e(a).form.items.name?e(a).form.items.name:"name")+"}"},"input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.name")})}},null,8,["label","modelValue","attr","input-attr"]),s(o,{label:e(l)("sms.variable.value_source"),type:"radio",modelValue:e(a).form.items.value_source,"onUpdate:modelValue":t[2]||(t[2]=r=>e(a).form.items.value_source=r),prop:"value_source",data:{content:{literal:e(l)("sms.variable.value_source literal"),func:e(l)("sms.variable.value_source func"),sql:e(l)("sms.variable.value_source sql")}},"input-attr":{placeholder:e(l)("Please select field",{field:e(l)("sms.variable.value_source")})}},null,8,["label","modelValue","data","input-attr"]),e(a).form.items.value_source=="literal"?(i(),u(o,{key:0,label:e(l)("sms.variable.value"),type:"string",modelValue:e(a).form.items.value,"onUpdate:modelValue":t[3]||(t[3]=r=>e(a).form.items.value=r),prop:"value","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.value")})}},null,8,["label","modelValue","input-attr"])):f("",!0),e(a).form.items.value_source=="sql"?(i(),u(o,{key:1,label:e(l)("sms.variable.sql"),type:"string",modelValue:e(a).form.items.sql,"onUpdate:modelValue":t[4]||(t[4]=r=>e(a).form.items.sql=r),prop:"sql","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.sql")})},attr:{blockHelp:"可使用 __PREFIX__ 表示数据表前缀，如 SELECT count(id) FROM __PREFIX__user 将在需要时自动使用 Db::query(SQL) 来获取变量值"}},null,8,["label","modelValue","input-attr","attr"])):f("",!0),e(a).form.items.value_source=="func"?(i(),g($,{key:2},[s(o,{label:e(l)("sms.variable.namespace"),type:"string",modelValue:e(a).form.items.namespace,"onUpdate:modelValue":t[5]||(t[5]=r=>e(a).form.items.namespace=r),prop:"namespace","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.namespace")})}},null,8,["label","modelValue","input-attr"]),s(o,{label:e(l)("sms.variable.class"),type:"string",modelValue:e(a).form.items.class,"onUpdate:modelValue":t[6]||(t[6]=r=>e(a).form.items.class=r),prop:"class","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.class")})}},null,8,["label","modelValue","input-attr"]),s(o,{label:e(l)("sms.variable.func"),type:"string",modelValue:e(a).form.items.func,"onUpdate:modelValue":t[7]||(t[7]=r=>e(a).form.items.func=r),prop:"func","input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.func")})}},null,8,["label","modelValue","input-attr"]),s(o,{label:e(l)("sms.variable.param"),type:"string",modelValue:e(a).form.items.param,"onUpdate:modelValue":t[8]||(t[8]=r=>e(a).form.items.param=r),prop:"param",attr:{blockHelp:"自动执行对应的方法并传递以上参数来获取变量的值"},"input-attr":{placeholder:e(l)("Please input field",{field:e(l)("sms.variable.param")})}},null,8,["label","modelValue","input-attr"])],64)):f("",!0),s(o,{label:e(l)("State"),modelValue:e(a).form.items.status,"onUpdate:modelValue":t[9]||(t[9]=r=>e(a).form.items.status=r),type:"radio",data:{content:{0:e(l)("Disable"),1:e(l)("Enable")},childrenAttr:{border:!0}}},null,8,["label","modelValue","data"])]),_:1},8,["model","label-width","rules"]))],6)]),_:1})),[[w,e(a).form.loading]])]),_:1},8,["model-value","onClose"])}}});export{h as _};
