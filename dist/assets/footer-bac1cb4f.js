import{D as K,_ as W}from"./darkSwitch-96b1df78.js";import{i as j,h as F,q as v,X as P,o as a,k as L,Y as H,Z as D,z as n,_ as M,O as l,P as s,W as C,V as I,U as f,$ as V,N as X,a0 as Y,r as Q,F as Z,p as y,m as w,n as ee,a1 as ne,a2 as te}from"./vue-99362bf9.js";import{d as ae,r as oe,b as G,u as B,a as q,c as se,s as re,_ as A,e as le,f as ie,g as ce}from"./index-a6f6b7ce.js";import{h as ue,o as R}from"./router-a223bf12.js";import{t as de}from"./useDark-0e743517.js";const me="/api/index/";function _e(k,x){ae(()=>{if(oe.currentRoute.value.meta.initialize===!1)return;const _=G(),r=B();if(!_.isLogin()&&r.initialize||_.isLogin()&&r.userInitialize)return;const d=q();se({url:me+"index",method:"get",params:{requiredLogin:x?1:0}}).then(i=>{re(i.data.site.siteName),ue(i.data.rules,i.data.menus),r.dataFill(i.data.site),d.setStatus(i.data.openMemberCenter),j(i.data.userInfo)||(i.data.userInfo.refresh_token=_.getToken("refresh"),_.dataFill(i.data.userInfo),r.setUserInitialize(!0)),i.data.openMemberCenter||d.setLayoutMode("Disable"),r.setInitialize(!0),typeof k=="function"&&k(i)})},200)()}const pe=F({__name:"menuSub",props:{menus:{default:()=>[]},showIcon:{type:Boolean,default:!1}},setup(k){const x=k,_=r=>{var d;r.path=="/"||((d=r.meta)==null?void 0:d.type)=="menu_dir"||R(r)};return(r,d)=>{const i=v("Icon"),c=v("el-menu-item"),h=v("el-sub-menu"),g=P("blur");return a(!0),L(D,null,H(x.menus,(p,z)=>{var S,b;return a(),L(D,{key:z},[n(j)(p.children)?M((a(),l(c,{key:1,onClick:o=>n(R)(p),index:"column-"+((b=p.meta)==null?void 0:b.id),class:V(p.name.replace(/[\/]/g,"-"))},{title:s(()=>{var o;return[I(f((o=p.meta)==null?void 0:o.title),1)]}),default:s(()=>{var o;return[r.showIcon?(a(),l(i,{key:0,name:(o=p.meta)==null?void 0:o.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):C("",!0)]}),_:2},1032,["onClick","index","class"])),[[g]]):M((a(),l(h,{key:0,onClick:o=>_(p),index:`column-${(S=p.meta)==null?void 0:S.id}`},{title:s(()=>{var o,e;return[r.showIcon?(a(),l(i,{key:0,name:(o=p.meta)==null?void 0:o.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):C("",!0),I(" "+f((e=p.meta)==null?void 0:e.title),1)]}),default:s(()=>[(a(!0),L(D,null,H(p.children,(o,e)=>{var t;return M((a(),l(c,{key:e,onClick:u=>n(R)(o),index:"column-"+((t=o.meta)==null?void 0:t.id),class:V(o.name.replace(/[\/]/g,"-"))},{title:s(()=>{var u;return[I(f((u=o.meta)==null?void 0:u.title),1)]}),default:s(()=>{var u;return[r.showIcon?(a(),l(i,{key:0,name:(u=o.meta)==null?void 0:u.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):C("",!0)]}),_:2},1032,["onClick","index","class"])),[[g]])}),128))]),_:2},1032,["onClick","index"])),[[g]])],64)}),128)}}});const T=A(pe,[["__scopeId","data-v-253da2e2"]]),fe={class:"header-user-box"},ve=["src"],he=F({__name:"menu",props:{showIcon:{type:Boolean,default:!1}},setup(k){const x=k,_=X(),r=Y(),d=le(),i=G(),c=B(),h=q(),g=Q({activeMenu:""}),p=e=>{var t,u;for(const m in h.state.navUserMenus)if(h.state.navUserMenus[m].path==e.path||h.state.navUserMenus[m].name==e.name)return(t=h.state.navUserMenus[m].meta)==null?void 0:t.id;for(const m in c.headNav)if(c.headNav[m].path==e.path||c.headNav[m].name==e.name)return(u=c.headNav[m].meta)==null?void 0:u.id},z=e=>{if(e.path=="/")return g.activeMenu="index";const t=p(e);t?g.activeMenu="column-"+t:e.path.startsWith("/user")&&(g.activeMenu="user")};z(_);const S=e=>{if(b(c.headNav,e)||b(h.state.navUserMenus,e)){const t=g.activeMenu;g.activeMenu="",ee(()=>{g.activeMenu=t})}},b=(e,t)=>t.indexOf("language-switch")===0||t=="theme-switch"?!0:o(e,t),o=(e,t)=>{var u,m,E;for(const U in e){if(`column-${(u=e[U].meta)==null?void 0:u.id}`==t)return((m=e[U].meta)==null?void 0:m.menu_type)=="link";if((E=e[U].children)!=null&&E.length)return o(e[U].children,t)}return!1};return Z(()=>_.path,()=>{z(_)}),(e,t)=>{const u=v("Icon"),m=v("el-menu-item"),E=v("el-sub-menu"),U=v("el-menu"),N=P("blur");return a(),l(U,{"default-active":g.activeMenu,onSelect:S},{default:s(()=>[M((a(),l(m,{onClick:t[0]||(t[0]=$=>n(r).push({name:"/"})),index:"index"},{title:s(()=>[I(f(e.$t("Home")),1)]),default:s(()=>[x.showIcon?(a(),l(u,{key:0,name:"fa fa-home",color:"var(--el-text-color-primary)"})):C("",!0)]),_:1})),[[N]]),y(T,{menus:n(c).headNav,"show-icon":e.showIcon},null,8,["menus","show-icon"]),n(h).state.open?(a(),L(D,{key:0},[n(i).isLogin()?M((a(),l(E,{key:0,onClick:t[3]||(t[3]=$=>e.$attrs.mode=="vertical"?"":n(r).push({name:"user"})),index:"user-box"},{title:s(()=>[w("div",fe,[w("img",{class:V(["header-user-avatar",e.$attrs.mode=="vertical"?"icon-header-user-avatar":""]),src:n(ie)(n(i).avatar?n(i).avatar:"/static/images/avatar.png"),alt:""},null,10,ve),I(" "+f(n(i).nickname),1)])]),default:s(()=>[M((a(),l(m,{onClick:t[1]||(t[1]=$=>n(r).push({name:"user"})),index:"user"},{default:s(()=>[e.showIcon?(a(),l(u,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):C("",!0),I(" "+f(e.$t("Member Center")),1)]),_:1})),[[N]]),y(T,{menus:n(h).state.navUserMenus,"show-icon":e.showIcon},null,8,["menus","show-icon"]),y(T,{menus:n(h).state.viewRoutes,"show-icon":e.showIcon},null,8,["menus","show-icon"]),M((a(),l(m,{onClick:t[2]||(t[2]=$=>n(i).logout()),index:"user-logout"},{default:s(()=>[e.showIcon?(a(),l(u,{key:0,name:"fa fa-sign-out",color:"var(--el-text-color-primary)"})):C("",!0),I(" "+f(e.$t("Logout login")),1)]),_:1})),[[N]])]),_:1})),[[N]]):M((a(),l(m,{key:1,onClick:t[4]||(t[4]=$=>n(r).push({name:"user"})),index:"user"},{default:s(()=>[e.showIcon?(a(),l(u,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):C("",!0),I(" "+f(e.$t("Member Center")),1)]),_:1})),[[N]]),M((a(),l(E,{index:"language-switch",class:"language-switch"},{title:s(()=>[e.showIcon?(a(),l(u,{key:0,name:"local-lang",color:"var(--el-text-color-primary)"})):C("",!0),I(" "+f(e.$t("Language")),1)]),default:s(()=>[(a(!0),L(D,null,H(n(d).lang.langArray,$=>(a(),l(m,{onClick:Me=>n(ce)($.name),key:$.name,index:"language-switch-"+$.value,class:"language-switch"},{default:s(()=>[e.showIcon?(a(),l(u,{key:0,name:"fa fa-circle-o",color:"var(--el-text-color-primary)"})):C("",!0),I(" "+f($.value),1)]),_:2},1032,["onClick","index"]))),128))]),_:1})),[[N]]),y(m,{index:"theme-switch",class:V(["theme-switch",e.$attrs.mode+"-theme-switch"])},{default:s(()=>[y(K,{onClick:t[5]||(t[5]=$=>n(de)())})]),_:1},8,["class"])],64)):C("",!0)]),_:1},8,["default-active"])}}});const O=A(he,[["__scopeId","data-v-f404ac53"]]),J=k=>(ne("data-v-d2397cc9"),k=k(),te(),k),ge=J(()=>w("img",{src:W},null,-1)),ye={class:"site-name"},ke={class:"header-row"},we=J(()=>w("img",{src:W},null,-1)),Ce={class:"site-name"},Ie=F({__name:"header",setup(k){const x=X(),_=Y(),r=B(),d=q();return Z(()=>x.path,()=>{d.toggleMenuExpand(!1)},{immediate:!0}),_e(),(i,c)=>{const h=v("Icon"),g=v("el-scrollbar"),p=v("el-col"),z=v("el-row"),S=v("el-drawer"),b=v("el-header");return a(),l(b,{class:"header"},{default:s(()=>[y(z,{justify:"center"},{default:s(()=>[y(p,{class:"header-row",xs:24,sm:24,md:16},{default:s(()=>[w("div",{onClick:c[0]||(c[0]=o=>n(_).push({name:"/"})),class:"header-logo"},[ge,w("span",ye,f(n(r).siteName),1)]),n(d).state.menuExpand?C("",!0):(a(),L("div",{key:0,onClick:c[1]||(c[1]=o=>n(d).toggleMenuExpand(!0)),class:"user-menus-expand hidden-md-and-up"},[y(h,{name:"fa fa-indent",color:"var(--el-color-primary)",size:"20"})])),y(g,{class:"hidden-sm-and-down"},{default:s(()=>[y(O,{class:"frontend-header-menu",ellipsis:!1,mode:"horizontal"})]),_:1})]),_:1})]),_:1}),y(S,{class:"ba-aside-drawer","append-to-body":!0,modelValue:n(d).state.menuExpand,"onUpdate:modelValue":c[4]||(c[4]=o=>n(d).state.menuExpand=o),"with-header":!1,direction:"ltr",size:"40%"},{default:s(()=>[w("div",ke,[w("div",{onClick:c[2]||(c[2]=o=>n(_).push({name:"/"})),class:"header-logo"},[we,w("span",Ce,f(n(r).siteName),1)]),w("div",{onClick:c[3]||(c[3]=o=>n(d).toggleMenuExpand(!1)),class:"user-menus-expand hidden-md-and-up"},[y(h,{name:"fa fa-dedent",color:"var(--el-color-primary)",size:"20"})])]),y(O,{"show-icon":!0,mode:"vertical"})]),_:1},8,["modelValue"])]),_:1})}}});const Le=A(Ie,[["__scopeId","data-v-d2397cc9"]]),xe={href:"http://beian.miit.gov.cn/"},$e=F({__name:"footer",setup(k){const x=B();return(_,r)=>{const d=v("el-footer");return a(),l(d,{class:"footer"},{default:s(()=>[w("div",null,[I(" Copyright @ 2020~2022 "+f(n(x).siteName)+" "+f(_.$t("Copyright"))+" ",1),w("a",xe,f(n(x).recordNumber),1)])]),_:1})}}});const Ee=A($e,[["__scopeId","data-v-5dadaf49"]]);export{Ee as F,Le as H,_e as i};
